<!doctype html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Распиcание лекций Школы Разработки Интерфейсов</title>
<meta name="description" content="Распиcание лекций Школы Разработки Интерфейсов">
<meta name="keywords" content="распиcание, ШРИ">
<meta name="author" content="Лукьянчук С.В.">

<meta name="viewport" content="width=device-width">

<script src="js/jquery.js"></script>

<script src="js/date-ru-RU.js"></script>

<link rel="stylesheet" type="text/css" href="style.css" />
<link rel="stylesheet" type="text/css" media="print" href="print.css" />

<script>

	var months = ['январь','февраль','март','апрель','май','июнь','июль','август','сентябрь','октябрь','ноябрь','декабрь'];
	var weekDays = ['воскресенье','понедельник','вторник','среда','четверг','пятница','суббота'];
	var weekDaysShrt = ['вс','пн','вт','ср','чт','пт','сб'];
 	
		var storageLength = localStorage.length;
	
		if(storageLength === 0) {
		
		var lectors = [
		{
		"name" : "Михаил Трошев",
		"photo" : "http://img-fotki.yandex.ru/get/6610/16051756.0/0_a5ee8_af749073_L",
		"link" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=77"
		},
		{
		"name" : "Сергей Бережной",
		"photo" : "http://img-fotki.yandex.ru/get/6413/16051756.0/0_a5ee9_e1a181e7_M",
		"link" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=89"
		},
		{
		"name" : "Виктор Ашик",
		"photo" : "http://avatars.yandex.net/get-avatar/103345/1194908534023-normal",
		"link" : "http://vashik.ya.ru/"
		},
		{
		"name" : "Вячеслав Олиянчук",
		"photo" : "http://img-fotki.yandex.ru/get/5605/miripiruni.0/0_727f7_90d798f3_L",
		"link" : "http://miripiruni.ya.ru/"
		},
		{
		"name" : "Георгий Мостоловица",
		"photo" : "http://img-fotki.yandex.ru/get/4003/gfranco.3/0_33d7f_fbc9803e_M",
		"link" : "http://gfranco.ya.ru/"
		},
		{
		"name" : "Сергей Сергеев",
		"photo" : "http://img-fotki.yandex.ru/get/6305/24969369.17/0_7f71f_571f11b4_M?log_nocount=64720402854",
		"link" : "http://gurugray.ya.ru/"
		},
		{
		"name" : "Марина Широчкина",
		"photo" : "http://moikrug.ru/img/3410/person_BigRound/195533509.jpg?modified=1349661754",
		"link" : "http://pancakyes.ya.ru/"
		},
		{
		"name" : "Павел Пушкарев",
		"photo" : "http://moikrug.ru/img/3011/person_Portrait/562433474.jpg?modified=1348684201",
		"link" : "http://paulus.moikrug.ru/"
		},
		{
		"name" : "Алексей Бережной",
		"photo" : "http://moikrug.ru/img/3912/person_Portrait/859747808.jpg?modified=1328695610",
		"link" : "http://berezhnoy-aleksey.moikrug.ru/"
		},
		{
		"name" : "Сергей Пузанков",
		"photo" : "http://moikrug.ru/img/3409/person_Portrait/212902874.jpg?modified=1308231025",
		"link" : "http://sergeypuzankov.moikrug.ru/"
		},
		{
		"name" : "Роман Комаров",
		"photo" : "http://avatars.yandex.net/get-avatar/1076905/2d6a0b2c6065e51eb2dc67eabac03357.6501-normal",
		"link" : "http://kizmarh.ya.ru/"
		},
		{
		"name" : "Егор Львовский",
		"photo" : "http://moikrug.ru/img/6604/person_Portrait/668323964.jpg?modified=1346584974",
		"link" : "http://lvivski.ya.ru/"
		},
		{
		"name" : "Тарас Иващенко",
		"photo" : "",
		"link" : ""
		},
		{
		"name" : "Алексей Воинов",
		"photo" : "",
		"link" : ""
		},
		{
		"name" : "Михаил Давыдов",
		"photo" : "",
		"link" : ""
		},
		{
		"name" : "Алексей Андросов",
		"photo" : "",
		"link" : ""
		},
		{
		"name" : "Иван Карев",
		"photo" : "",
		"link" : ""
		},
		{
		"name" : "Михаил Корепанов",
		"photo" : "",
		"link" : ""
		},
		{
		"name" : "Максим Ширшин",
		"photo" : "",
		"link" : ""
		},
		{
		"name" : "Михаил Трошев",
		"photo" : "",
		"link" : ""
		},
		{
		"name" : "Владимир Варанкин",
		"photo" : "",
		"link" : ""
		},
		{
		"name" : "Константин Горский",
		"photo" : "",
		"link" : ""
		}		
	];
	localStorage.lectors = JSON.stringify(lectors, "", 4); 

	var lections = 
		[	
			{
				"time" : "12:00",
				"name" : "Общий цикл",
				"lector" : "0",
				"video" : "http://yadi.sk/d/Lr0Y4WO606jTc",
				"ppt" : "http://yadi.sk/d/VDsJ4ZUBiq6u",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=35",
				"descr" : ""
			},
			{
				"time" : "13:00",
				"name" : "Task Tracker",
				"lector" : "1",
				"video" : "http://yadi.sk/d/D5xTwoIciq6c",
				"ppt" : "",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=37",
				"descr" : "Системы ведения задач"
			},
			{
				"time" : "14:00",
				"name" : "Wiki",
				"lector" : "1",
				"video" : "",
				"ppt" : "http://yadi.sk/d/7F9PuECdiq6G",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=40",
				"descr" : ""
			},
			{
				"time" : "19:00",
				"name" : "Командная строка Unix",
				"lector" : "2",
				"video" : "http://yadi.sk/d/O5OBYxHwnGTw",
				"ppt" : "http://yadi.sk/d/3N0d6h9rlRA8",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=116",
				"descr" : ""
			},
			{
				"time" : "20:00",
				"name" : "Редакторы кода",
				"lector" : "3",
				"video" : "http://yadi.sk/d/f3CYmlG3nGSC",
				"ppt" : "https://github.com/yandex-shri/lectures/blob/master/05-editors.md",
				"task" : "",
				"github" : "https://github.com/yandex-shri/lectures/blob/master/05-editors.md",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=118",
				"descr" : ""
			},
			{
				"time" : "19:00",
				"name" : "Браузеры",
				"lector" : "4",
				"video" : "http://yadi.sk/d/NMOTG5lEqZdM",
				"ppt" : "http://yadi.sk/d/-VjNYqjTqTca",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=171",
				"descr" : ""
			},
			{
				"time" : "20:00",
				"name" : "Системы контроля версий ",
				"lector" : "5",
				"video" : "http://yadi.sk/d/Ujsir9QwqZeA",
				"ppt" : "http://yadi.sk/d/a7aY8YXjr-hs",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=173",
				"descr" : ""
			},
			{
				"time" : "12:00",
				"name" : "Тестирование",
				"lector" : "6",
				"video" : "http://yadi.sk/d/oNwA5A9NqZcc",
				"ppt" : "http://yadi.sk/d/W7lDOetHqTWC",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=260",
				"descr" : ""
			},
			{
				"time" : "13:00",
				"name" : "Развертывание верстки",
				"lector" : "7",
				"video" : "http://yadi.sk/d/7DVNQDK9qZbq",
				"ppt" : "http://yadi.sk/d/N4FYrhS3qTSI",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=261",
				"descr" : ""
			},
			{
				"time" : "14:00",
				"name" : "HTTP-протокол",
				"lector" : "8",
				"video" : "http://yadi.sk/d/Tr1gzBsOqZao",
				"ppt" : "http://yadi.sk/d/waP8x8maqTKM",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=262",
				"descr" : ""
			},
			{
				"time" : "18:00",
				"name" : "XML",
				"lector" : "9",
				"video" : "http://yadi.sk/d/LyYgXl_C0-6oI",
				"ppt" : "http://yadi.sk/d/PLpXM88frhSW",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=404",
				"descr" : ""
			},
			{
				"time" : "19:00",
				"name" : "XPath",
				"lector" : "9",
				"video" : "http://yadi.sk/d/cTZ1D0UU0-6v6",
				"ppt" : "http://yadi.sk/d/PLpXM88frhSW",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=404",
				"descr" : ""
			},
			{
				"time" : "20:00",
				"name" : "XSLT",
				"lector" : "9",
				"video" : "http://yadi.sk/d/0KxriIDd0-7Ni",
				"ppt" : "http://yadi.sk/d/PLpXM88frhSW",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=404",
				"descr" : ""
			},
			{
				"time" : "19:00",
				"name" : "Механизм работы браузера",
				"lector" : "10",
				"video" : "",
				"ppt" : "http://yadi.sk/d/wo1LfOGatbOM",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=492",
				"descr" : ""
			},
			{
				"time" : "20:00",
				"name" : "Кеширование на клиенте и сервере",
				"lector" : "11",
				"video" : "http://yadi.sk/d/vTmZ5k1a0-74y",
				"ppt" : "http://yadi.sk/d/EEEp53YstbNo",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=493",
				"descr" : ""
			},
			{
				"time" : "19:00",
				"name" : "Безопасность веб-приложений",
				"lector" : "12",
				"video" : "",
				"ppt" : "http://yadi.sk/d/bo1OpD2Av3vC",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=548",
				"descr" : ""
			},
			{
				"time" : "20:00",
				"name" : "Языки программирования ",
				"lector" : "13",
				"video" : "",
				"ppt" : "http://yadi.sk/d/LRpqvLuIv4UI",
				"task" : "",
				"github" : "",
				"club" : "http://clubs.ya.ru/4611686018427468886/replies.xml?item_no=549",
				"descr" : ""
			}			
		];		
		
	localStorage.lections = JSON.stringify(lections, "", 4); 

	var weeksDescriptions = [
        {
            "name" : "Открытие",
            "meta" : ["техологии", "инструменты"]
		},
        {
            "name" : "1 неделя",
            "meta" : ["инстурменты", "инструменты"]
        },
        {
            "name" : "2 неделя",
            "meta" : ["инстурменты", "инструменты"]
        },
        {
            "name" : "3 неделя",
            "meta" : ["инстурменты", "инструменты"]
        }
    ];
	
	localStorage.weeksDescriptions = JSON.stringify(weeksDescriptions, "", 4);
	
	var weeks = [
		{
		"15.09.2012" : [0, 1, 2]
		},
		{
		"18.09.2012" : [3, 4],
		"20.09.2012" : [5, 6],
		"22.09.2012" : [7, 8, 9]
		},
		{
		"24.09.2012" : [10, 11, 12],
		"25.09.2012" : [13, 14],
		"27.09.2012" : [15, 16]
		}
	];
		
	localStorage.weeks = JSON.stringify(weeks, "", 4);
	}
    
	var lections = JSON.parse(localStorage.lections);
    var weeks = JSON.parse(localStorage.weeks);
    var lectors = JSON.parse(localStorage.lectors);
    var weeksDescriptions = JSON.parse(localStorage.weeksDescriptions);

    var GetTextDate = function (day, format) {
        var date = Date.parse(day);

        switch (format) {
            case "weeksDate":
                var dayNumber = date.getDate();
                var monthNumber = date.getMonth()+1;
                if (monthNumber < 10) {
                    monthNumber = '0'+monthNumber;
                }
                var dayWeekText = weekDaysShrt[date.getDay()];
                return dayNumber+'.'+monthNumber+' '+dayWeekText;
				
			case "lectionsDate":
				var dayNumber = date.getDate();
                var monthText = months[date.getMonth()+1];                
                var dayWeekText = weekDays[date.getDay()];
				return '<span class="b-lections-date__day">'+dayWeekText+'</span><span class="b-lections-date__month">'+monthText+'</span><span class="b-lections-date__date">'+dayNumber+'</span>';
				
			case "lectionDate":
                var dayNumber = date.getDate();
                var monthNumber = date.getMonth()+1;
                if (monthNumber < 10) {
                    monthNumber = '0'+monthNumber;
                }
                var dayWeekText = weekDays[date.getDay()];
                return dayNumber+'.'+monthNumber+' '+dayWeekText;
			
        }

        return '';
    }

    function GetWeeksHtml() {
        var html = '<ul class="b-nav__list">';
        var weekIndex;
        for (weekIndex = 0; weekIndex < weeks.length; ++weekIndex) {
            var week = weeks[weekIndex];
            var weekDescription = weeksDescriptions[weekIndex];

            html += '<li class="b-nav__item"><a href="#" class="b-nav__link">'+weekDescription.name
                    +'</a><div class="b-week"><ul class="b-week__list">';

            var day;
            for (day in week) {
                if (!week.hasOwnProperty(day)) {
                    continue;
                }

                var lectionIndex;
                var dayLections = week[day];
                for(lectionIndex in dayLections) {
                    if (!dayLections.hasOwnProperty(lectionIndex)) {
                        continue;
                    }

                    var lectionId = dayLections[lectionIndex];
                    html += '<li class="b-week__item"><a href="#" class="b-week__link b-open__lection" data-id='+lectionId+'><span class="b-week__date">'+GetTextDate(day, 'weeksDate')+'</span> '+lections[lectionId].name+'</a></li>';

                }
            }
            html += '</ul></div></li>';

        }
        html += '</ul>';
        return html;
    }
	
	function GetLectionsHtml(){
		var html = '';
		var weekIndex;
		for (weekIndex = 0; weekIndex < weeks.length; ++weekIndex) {
			var week = weeks[weekIndex];
			var weekDescription = weeksDescriptions[weekIndex];
				
			html += '<h1 class="b-timetable__weekname">'+weekDescription.name+'</h1>';	
				
			for (var metaIndex in weekDescription.meta) {					
				html += '<span class="b-timetable__meta"> '+weekDescription.meta[metaIndex]+'</span>';
			}
				
			html += '<ul class="b-lections">';
			
			var day;
			for (day in week) {
				if (!week.hasOwnProperty(day)) {
					continue;
				}
				
				html += '<li class="b-lections__day">';
				html += '<div class="b-lections-date">'+GetTextDate(day, 'lectionsDate')+'</div><span class="b-lections__meta"></span>';
				
				var lectionIndex;
				var dayLections = week[day];
				for(lectionIndex in dayLections) {
					if (!dayLections.hasOwnProperty(lectionIndex)) {
						continue;
					}

					var lectionId = dayLections[lectionIndex];
					var lectorId = lections[lectionId].lector;
						
					html += '<div class="b-lections__lection"><a href="#" class="b-lections__link b-open__lection" data-id='+lectionId+'><span class="b-lections__time">'+lections[lectionId].time+'</span> '+lections[lectionId].name+' <span class="b-lections__lector">('+lectors[lectorId].name+')</span></a><div class="b-icons"><a class="b-icons__link b-icons__video ';
						
					if(lections[lectionId].video != '') {
						html += 'b-icons__type_on" href="'+lections[lectionId].video;					
					}					
						
					html += '"></a><a class="b-icons__link b-icons__ppt ';
						
					if(lections[lectionId].ppt != '') {
						html += 'b-icons__type_on" href="'+lections[lectionId].ppt;						
					}
						
					html += '"></a><a class="b-icons__link b-icons__task ';
					
					if(lections[lectionId].task != '') {
						html += 'b-icons__type_on b-open__lection" data-id="'+lectionId+'"';				
					}
						
					html += '"></a></div></div>';
												
				}
				
				html += '</li>';	
			
			}
			html += '</ul>';
		}		
		return html;
	}
	
	function GetLectionHtml(id) {
				
		var viewLection = lections[id];
			
		var dateLection;
			
		var weekIndex;
		for (weekIndex = 0; weekIndex < weeks.length; ++weekIndex) {
			var week = weeks[weekIndex];
			var day; 
			for (day in week) {
				if (!week.hasOwnProperty(day)) {
				continue;
				}
				var lectionIndex;
				var dayLections = week[day];
				for(lectionIndex in dayLections) {
					if (!dayLections.hasOwnProperty(lectionIndex)) {
						continue;
					}
					if(parseInt(dayLections[lectionIndex]) === parseInt(id)) {
							
						dateLection = day;
						break;
					}
				}
			}
		}
				
		$(".b-lection").data('id', id);
			
		if(viewLection.name != '') {
			$(".b-lection__name").text(viewLection.name);		
		} else {
			$(".b-lection__name").text("Название лекции");	
		}
				
		
		$(".b-lection__date").text(GetTextDate(dateLection, 'lectionDate')+", "+viewLection.time);
			
			
		if(viewLection.video != '') {
			$(".b-lection__link_type_video").attr({"href": viewLection.video, "style": "background-position: 0 0;"});		
		} else {
			$(".b-lection__link_type_video").removeAttr("href").removeAttr("style");	
		}
			
		if(viewLection.ppt != '') {
			$(".b-lection__link_type_ppt").attr({"href": viewLection.ppt, "style": "background-position: 0 0;"});		
		} else {
			$(".b-lection__link_type_ppt").removeAttr("href").removeAttr("style");	
		}
			
		if(viewLection.github != '') {
			$(".b-lection__link_type_github").attr({"href": viewLection.github, "style": "background-position: 0 0;"});		
		} else {
			$(".b-lection__link_type_github").removeAttr("href").removeAttr("style");	
		}
			
		if(viewLection.club != '') {
			$(".b-lection__link_type_club").attr({"href": viewLection.club, "style": "background-position: 0 0;"});		
		} else {
			$(".b-lection__link_type_club").removeAttr("href").removeAttr("style");	
		}
			
		if(viewLection.task != '') {
			$(".b-lection__link_type_task").attr("style", "background-position: 0 0;");	
			$(".b-edit__task").text(viewLection.task);					
		} else {
			$(".b-lection__link_type_task").removeAttr("style");	
			$(".b-edit__task").text("Задание");					
		}
			
		if(viewLection.descr != '') {
			$(".b-lection__link_type_descr").attr("style", "background-position: 0 0;");	
			$(".b-edit__descr").text(viewLection.descr);					
		} else {
			$(".b-lection__link_type_descr").removeAttr("style");	
			$(".b-edit__descr").text("Описание");					
		}
						
		if(viewLection.lector != '') {
			$(".b-edit__lectorname").text(lectors[viewLection.lector].name);
			if(lectors[viewLection.lector].link != ''){
				$(".b-lector__name").attr("href", lectors[viewLection.lector].link);		
			} else {
				$(".b-lector__name").removeAttr("href");
			}
			if(lectors[viewLection.lector].photo != ''){
				$(".b-lector__img").attr("src", lectors[viewLection.lector].photo);		
			} else {
				$(".b-lector__img").attr("src", "pic1.jpg");
			}
		}			
		$(".b-popup").show();
		$(".b-week").removeAttr("style");
		
	}
	

	$('.b-open__lection').live("click",function(){
		var id = $(this).data('id');		
		GetLectionHtml(id);		
	});

	
	
    	
	
	var html = '';
	html += '<div class="b-nav">';
    html += GetWeeksHtml();
	html += '</div>';
	html += '<div class="b-update"><div class="b-update__link"><a href="#" class="b-update__enter b-update__btn">Обновить расписание</a></div><div class="b-update__block"><textarea name="b-update__value" class="b-update__text"></textarea><br /><a href="#" class="b-update__close">Закрыть</a><a href="#" class="b-update__clear">Очистить</a><a href="#" class="b-update__send b-update__btn">Отправить</a></div></div>';
	html += '<div class="b-timetable">';
	html += GetLectionsHtml();
	html += '</div>';

	
	
	html += '<div class="b-popup" style="display: none;"><i class="b-popup__close"></i><div class="b-lection" data-id="id"><div class="b-lection__descr"><h1><div class="b-edit" data-type="name"><span class="b-lection__name">Название</span><input type="text" class="b-edit__value" style="display: none;" value="" /><i class="b-edit__ico"></i></div></h1><div class="b-edit" data-type="date"><span class="b-lection__date">Дата</span><select size="3" class="b-edit__value" style="display: none;"></select><i class="b-edit__ico"></i></div><ul><li class="b-lection__video"><div class="b-edit" data-type="video"><a href="#" class="b-icons__video b-lection__link b-lection__link_type_video"><span>Видео</span></a><input type="text" class="b-edit__value" style="display: none;" value="" /><i class="b-edit__ico"></i></div></li><li class="b-lection__ppt"><div class="b-edit" data-type="ppt"><a href="#" class="b-icons__ppt b-lection__link b-lection__link_type_ppt"><span>Презентация</span></a><input type="text" class="b-edit__value" style="display: none;" value="" /><i class="b-edit__ico"></i></div></li><li class="b-lection__github"><div class="b-edit" data-type="github"><a href="#" class="b-icons__github b-lection__link b-lection__link_type_github"><span>GitHUB</span></a><input type="text" class="b-edit__value" style="display: none;" value="" /><i class="b-edit__ico"></i></div></li><li class="b-lection__club"><div class="b-edit" data-type="club"><a href="#" class="b-icons__club b-lection__link b-lection__link_type_club"><span>Обсуждения в Клубе</span></a><input type="text" class="b-edit__value" style="display: none;" value="" /><i class="b-edit__ico"></i></div></li><li class="b-lection__task"><div class="b-edit" data-type="task"><a href="#" class="b-icons__task b-lection__link b-lection__link_type_task"><span class="b-edit__task">Задание</span></a><input type="text" class="b-edit__value" style="display: none;" value="" /><i class="b-edit__ico"></i></div></li><li class="b-lection__descr"><div class="b-edit" data-type="descr"><a href="#" class="b-icons__descr b-lection__link b-lection__link_type_descr"><span class="b-edit__descr">Описание</span></a><input type="text" class="b-edit__value" style="display: none;" value="" /><i class="b-edit__ico"></i></div></li></ul></div><div class="b-lector"><img src="pic1.jpg" alt="" class="b-lector__img"/><div class="b-edit" data-type="lector"><a href="#" class="b-lector__name"><span class="b-edit__lectorname">Имя лектора</span></a><select size="3" class="b-edit__value" style="display: none;"></select><i class="b-edit__ico"></i></div></div></div></div>';
	

	
	
	var GetDayLection = function (id) {
		var dayLection;			
				var weekIndex;
				for (var weekIndex = 0; weekIndex < weeks.length; ++weekIndex) {
					var week = weeks[weekIndex];
					var day; 
					for (var day in week) {
						if (!week.hasOwnProperty(day)) {
							continue;
						}
						var lectionIndex;
						var dayLections = week[day];
						for(lectionIndex in dayLections) {
							if (!dayLections.hasOwnProperty(lectionIndex)) {
								continue;
							}
							if(parseInt(dayLections[lectionIndex]) === parseInt(id)) {									
								dayLection = day;
								break;
							}
						}
					}
				}
		return dayLection;
    }

	
	
	
	
	$(document).ready(function(){
		$('body').html(html);			
		
		$(".b-edit__ico").live("click", function(){ 
			var lectionKey = $(this).closest(".b-edit").data("type");
			var id = $(this).closest(".b-lection").data("id");
			if(lectionKey === 'date') {
				$(this).prev(".b-edit__value").show();
				
				
				$(".b-edit__value").html("");
				for (weekIndex = 0; weekIndex < weeks.length; ++weekIndex) {
					var week = weeks[weekIndex];
					var day; 
					for (day in week) {				
						$(".b-edit__value").append("<option value='"+day+"'>"+day+"</option>");
						
					}					
				}
				var dayLection = GetDayLection(id);
				$(".b-edit__value [value='"+dayLection+"']").attr("selected", "selected");
				$("select").focus();
				$(this).prevAll("span").attr("style","display: none;");					
			} else if(lectionKey === 'lector') {
				$(this).prev(".b-edit__value").show();
				$(".b-edit__value").html("");
				var lectionLector = lections[id].lector;
				for (var lectorIndex in lectors) {
					var currentLector = lectors[lectorIndex];					
					$(".b-edit__value").append("<option value='"+lectorIndex+"'>"+currentLector.name+"</option>");									
				}
				$(".b-edit__value [value='"+lectionLector+"']").attr("selected", "selected");
				$("select").focus();	
				$(this).prevAll("a").find("span").attr("style","display: none;");	
			} else if(lectionKey === 'name') {
				$(this).prev(".b-edit__value").attr("value", lections[id][lectionKey]).show();				
				$(this).prevAll(".b-lection__name").attr("style","display: none;");	
				$("input").focus();
			}
			else {
				$(this).prev(".b-edit__value").attr("value", lections[id][lectionKey]).show();			
				$(this).prevAll("a").find("span").attr("style","display: none;");					
				$("input").focus();
			}
			$(this).hide();
			
			
		});
		
		$(".b-edit__value").live("focusout", function() {
			var value = $(this).val();
			var lectionKey = $(this).closest('.b-edit').data('type');
			var id = $(this).closest('.b-lection').data('id');
			var currentLection = lections[id];
			

			var dayLection = GetDayLection(id);
			if(lectionKey === 'date') {
				if(value != dayLection) {
					
					var weekIndex;
					for (weekIndex = 0; weekIndex < weeks.length; ++weekIndex) {
						var week = weeks[weekIndex];
						var day; 
						for (day in week) {
							if (!week.hasOwnProperty(day)) {
							continue;
							}
							if(day === dayLection) {								
								var dayLections = week[day];
								for(var lectionIndex in dayLections) {
									if (parseInt(dayLections[lectionIndex]) === parseInt(id)) {								
										dayLections.splice(lectionIndex,1); 						
									}
								}
							}
							if(day === value) {								
								var dayLections = week[day];
								dayLections.push(id);
							}
						}
					}
					
				}
			}else { 
				if(lectionKey === 'lector') {				
					if(lectors[currentLection.lector].link != ''){
						$(".b-lector__name").attr("href", lectors[currentLection.lector].link);		
					} else {
						$(".b-lector__name").removeAttr("href");
					}
					if(lectors[currentLection.lector].photo != ''){
						$(".b-lector__img").attr("src", lectors[currentLection.lector].photo);		
					} else {
						$(".b-lector__img").attr("src", "pic1.jpg");
					}				
				}
			
				lections[id][lectionKey] = value;			
			}
			localStorage.lections = JSON.stringify(lections, "", 4); 
			lections = JSON.parse(localStorage.lections);
			$(this).hide();
			
			if(lectionKey === 'lector') {
				$(".b-edit__lectorname").show();								
			} else if(lectionKey === 'name') {
				$(this).prev(".b-lection__name").show();
			}
			else {
				$(this).prevAll(".b-lection__link").find("span").show();
			}
			$(this).next(".b-edit__ico").show();
			GetLectionHtml(id);
			$(".b-timetable").html(GetLectionsHtml());
			$(".b-nav").html(GetWeeksHtml());
		});
			
			
		$(".b-popup__close").live("click", function(){ 
			$(".b-popup").hide();
			$(".b-timetable").html(GetLectionsHtml());
			$(".b-nav").html(GetWeeksHtml());
		});
		
		
		$(".b-update__enter").live("click", function() {
			$(this).hide();
			$(".b-update__block").show();
			$(".b-update__text").val('');			
			$(".b-update__text").focus();
		
		});
		
		$(".b-update__close").live("click", function() {
			$(".b-update__block").hide();
			$(".b-update__enter").show();
		});
		
		$(".b-update__clear").click(function(){
			$(".b-update__text").val('');
			
		});
		
		$(".b-update__send").click(function(){
			localStorage.clear(); 	
			var timetable = JSON.parse($(".b-update__text").val());
			localStorage.lectors = JSON.stringify(timetable.lectors, "", 4);
			localStorage.lections = JSON.stringify(timetable.lections, "", 4);
			localStorage.weeks = JSON.stringify(timetable.weeks, "", 4);
			localStorage.weeksDescriptions = JSON.stringify(timetable.weeksDescriptions, "", 4);
			
			$(".b-update__block").hide();
			$(".b-update__enter").show();
			$(".b-nav").html(GetWeeksHtml());
			$(".b-timetable").html(GetLectionsHtml());
		});
		
	});
	


	
	
	
	
	
</script>

	
</head>



<body>
 <!--[if lt IE 8]><p class=chromeframe>Ваш браузер <em>устарел!</em> <a href="http://browsers.yandex.ru/">Обновите свой браузер</a> или <a href="http://www.google.com/chromeframe/?redirect=true">установите Google Chrome Frame</a> чтобы продолжить работу с сайтом.</p><![endif]-->

 

<!--

<div class="b-nav">
	<ul class="b-nav__list">
		<li class="b-nav__item"><a href="#" class="b-nav__link">1 неделя</a>
			<div class="b-week">
				<ul class="b-week__list">
					<li class="b-week__item"><a href="#" class="b-week__link"><span class="b-week__date">18.09 вт</span> Командная строка Unix</a></li>
					<li class="b-week__item"><a href="#" class="b-week__link"><span class="b-week__date">18.09 вт</span> Командная строка Unix</a></li>
					<li class="b-week__item"><a href="#" class="b-week__link"><span class="b-week__date">18.09 вт</span> Командная строка Unix</a></li>
					<li class="b-week__item"><a href="#" class="b-week__link"><span class="b-week__date">18.09 вт</span> Командная строка Unix</a></li>
					<li class="b-week__item"><a href="#" class="b-week__link"><span class="b-week__date">18.09 вт</span> Командная строка Unix</a></li>
					<li class="b-week__item"><a href="#" class="b-week__link"><span class="b-week__date">18.09 вт</span> Командная строка Unix</a></li>
				</ul>
			</div>
		</li>
		<li class="b-nav__item"><a href="#" class="b-nav__link">2 неделя</a></li>
		<li class="b-nav__item"><a href="#" class="b-nav__link">3 неделя</a></li>
		<li class="b-nav__item b-nav__item_pos_last"><a href="#" class="b-nav__link">4 неделя</a></li>
	</ul>
</div>
<div class="b-update">
	<a href="#" class="b-update__enter b-update__link">Обновить расписание</a>
	<textarea name="b-update__value" class="b-update__text"></textarea>
	<a href="#" class="b-update__send b-update__link">Отправить</a>	
</div>
<div class="b-timetable">
	<h1>1 неделя</h1> <span class="b-timetable__meta">инструменты</span> <span class="b-timetable__meta">технологии</span>
	<div class="b-popup">			
		<i class="b-popup__close"></i>
		<div class="b-lection">

			<div class="b-lection__descr">
				<h1 class="b-popup__title">Командная строка Unix</h1>
				<span  class="b-lection__date">18 сентября, вторник 19-00</span>
				<ul class="b-speclinks">
					<li class="b-speclinks__item"><a href="#" class="b-speclinks__link b-icons__video b-icons__video_type_off"><span>Видео</span></a></li><div class="b-edit" data-type="name"><span></span><i class="b-edit__ico"></i></div>
					<li class="b-speclinks__item"><a href="#" class="b-speclinks__link b-icons__ppt"><span>Презентация</span></a></li>
					<li class="b-speclinks__item"><a href="#" class="b-speclinks__link b-icons__task"><span>Задание</span></a></li>
					<li class="b-speclinks__item"><a href="#" class="b-speclinks__link"><span>GitHUB</span></a></li>
					<li class="b-speclinks__item"><a href="#" class="b-speclinks__link"><span>Обсуждения в клубе</span></a></li>
				</ul>
				<p>Тезисы, описание лекции</p>
			</div>
			<div class="b-lection__author">
				<img src="pic1.jpg" alt="" />
				<a href="#">Виктор Ашик</a>
			</div>
		</div>
	</div>
	<ul class="b-lections">
		<li class="b-lections__day">
			<div class="b-lections__lection">
				<a href="#" class="b-lections__link"><span class="b-lections__time">19-00</span> Командная строка Unix</a>
				<div class="b-icons">
					<a class="b-icons__link b-icons__video" href="#"></a>
					<a class="b-icons__link b-icons__ppt" href="#"></a>
					<a class="b-icons__link b-icons__task b-icons__task_type_off" href="#"></a>
				</div>
			</div>
			<div class="b-lections__lection">
				<a href="#" class="b-lections__link"><span class="b-lections__time">20-00</span> Редакторы кода</a>
				<div class="b-icons">
					<a class="b-icons__link b-icons__video b-icons__video_type_off" href="#"></a>
					<a class="b-icons__link b-icons__ppt" href="#"></a>
					<a class="b-icons__link b-icons__task b-icons__task_type_off" href="#"></a>
				</div>
			</div>
			<div class="b-lections-date">
				<span class="b-lections-date__day">вторник</span>
				<span class="b-lections-date__month">октябрь</span>
				<span class="b-lections-date__date">18</span>
			</div>
			<span class="b-lections__meta"></span>
		</li>
		
		<li class="b-lections__day">
			<div class="b-lections__lection">
				<a href="#" class="b-lections__link"><span class="b-lections__time">19-00</span> Командная строка Unix</a>
				<div class="b-icons">
					<a class="b-icons__link b-icons__video" href="#"></a>
					<a class="b-icons__link b-icons__ppt" href="#"></a>
					<a class="b-icons__link b-icons__task b-icons__task_type_off" href="#"></a>
				</div>
			</div>
			<div class="b-lections__lection">
				<a href="#" class="b-lections__link"><span class="b-lections__time">20-00</span> Редакторы кода</a>
				<div class="b-icons">
					<a class="b-icons__link b-icons__video b-icons__video_type_off" href="#"></a>
					<a class="b-icons__link b-icons__ppt" href="#"></a>
					<a class="b-icons__link b-icons__task b-icons__task_type_off" href="#"></a>
				</div>
			</div>
			<div class="b-lections-date">
				<span class="b-lections-date__day">вторник</span>
				<span class="b-lections-date__month">октябрь</span>
				<span class="b-lections-date__date">18</span>
			</div>
			<span class="b-lections__meta"></span>
		</li>
		
		<li class="b-lections__day">
			<div class="b-lections__lection">
				<a href="#" class="b-lections__link"><span class="b-lections__time">19-00</span> Командная строка Unix</a>
				<div class="b-icons">
					<a class="b-icons__link b-icons__video" href="#"></a>
					<a class="b-icons__link b-icons__ppt" href="#"></a>
					<a class="b-icons__link b-icons__task b-icons__task_type_off" href="#"></a>
				</div>
			</div>
			<div class="b-lections__lection">
				<a href="#" class="b-lections__link"><span class="b-lections__time">20-00</span> Редакторы кода</a>
				<div class="b-icons">
					<a class="b-icons__link b-icons__video b-icons__video_type_off" href="#"></a>
					<a class="b-icons__link b-icons__ppt" href="#"></a>
					<a class="b-icons__link b-icons__task b-icons__task_type_off" href="#"></a>
				</div>
			</div>
			<div class="b-lections-date">
				<span class="b-lections-date__day">вторник</span>
				<span class="b-lections-date__month">октябрь</span>
				<span class="b-lections-date__date">18</span>
			</div>
			<span class="b-lections__meta">факультативно</span>
		</li>
	</ul>
</div>
-->
<script>

</script>

</body>
</html>












